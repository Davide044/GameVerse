<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Block Blast</title>
<style>
body { font-family: Arial; text-align:center; background:#222; color:white; }
canvas { display:block; margin:20px auto; background:#333; border-radius:10px; }
button { margin:5px; padding:10px 15px; border:none; border-radius:5px; background:#4CAF50; color:white; cursor:pointer; }
button:hover { background:#45a049; }
.touch-controls { display:flex; justify-content:center; margin-top:10px; }
.touch-controls button { width:50px; height:50px; margin:5px; font-size:20px; }
</style>
</head>
<body>
<h1>Block Blast</h1>
<canvas id="game" width="400" height="400"></canvas><br>
<button id="playBtn">Play</button>
<button id="pauseBtn">Pausa</button>
<button id="replayBtn">Replay</button>

<div class="touch-controls">
  <button id="left">⬅️</button>
  <button id="right">➡️</button>
</div>

<script>
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");

let paddle={x:170,y:370,w:60,h:10}, ball={x:200,y:200,dx:4,dy:-4,r:8}, bricks=[];
let rows=5,cols=6,brickW=60,brickH=20,interval=null;

// creare bricks
for(let r=0;r<rows;r++){
  for(let c=0;c<cols;c++){
    bricks.push({x:c*(brickW+10)+20,y:r*(brickH+10)+20,status:1});
  }
}

let left=false,right=false;

function draw(){
  ctx.fillStyle="#333";
  ctx.fillRect(0,0,canvas.width,canvas.height);

  // paddle
  ctx.fillStyle="lime";
  ctx.fillRect(paddle.x,paddle.y,paddle.w,paddle.h);

  // ball
  ctx.fillStyle="red";
  ctx.beginPath();
  ctx.arc(ball.x,ball.y,ball.r,0,Math.PI*2);
  ctx.fill();

  // bricks
  bricks.forEach(b=>{
    if(b.status===1){
      ctx.fillStyle="yellow";
      ctx.fillRect(b.x,b.y,brickW,brickH);
    }
  });
}

function update(){
  // paddle movimento
  if(left && paddle.x>0) paddle.x-=6;
  if(right && paddle.x+paddle.w<canvas.width) paddle.x+=6;

  // ball movimento
  ball.x+=ball.dx; ball.y+=ball.dy;

  // collisioni muri
  if(ball.x<ball.r || ball.x>canvas.width-ball.r) ball.dx*=-1;
  if(ball.y<ball.r) ball.dy*=-1;
  if(ball.y>canvas.height){ pauseGame(); alert("Game Over!"); }

  // collisione paddle
  if(ball.y+ball.r>paddle.y && ball.x>paddle.x && ball.x<paddle.x+paddle.w) ball.dy*=-1;

  // collisione bricks
  bricks.forEach(b=>{
    if(b.status===1 && ball.x>b.x && ball.x<b.x+brickW && ball.y-b.r<b.y+brickH && ball.y+ball.r>b.y){
      ball.dy*=-1; b.status=0;
    }
  });

  draw();
}

function startGame(){ if(!interval) interval=setInterval(update,20); }
function pauseGame(){ clearInterval(interval); interval=null; }
function replayGame(){
  pauseGame();
  ball={x:200,y:200,dx:4,dy:-4,r:8};
  paddle={x:170,y:370,w:60,h:10};
  bricks.forEach(b=>b.status=1);
  startGame();
}

document.getElementById("playBtn").onclick=startGame;
document.getElementById("pauseBtn").onclick=pauseGame;
document.getElementById("replayBtn").onclick=replayGame;

// tasti PC
document.addEventListener("keydown",e=>{
  if(["ArrowLeft","KeyA"].includes(e.code)) left=true;
  if(["ArrowRight","KeyD"].includes(e.code)) right=true;
});
document.addEventListener("keyup",e=>{
  if(["ArrowLeft","KeyA"].includes(e.code)) left=false;
  if(["ArrowRight","KeyD"].includes(e.code)) right=false;
});

// touch
document.getElementById("left").onclick=()=>{ paddle.x-=20; if(paddle.x<0)paddle.x=0; }
document.getElementById("right").onclick=()=>{ paddle.x+=20; if(paddle.x+paddle.w>canvas.width)paddle.x=canvas.width-paddle.w; }

ctx.fillStyle="white";
ctx.font="20px Arial";
ctx.fillText("Premi Play per iniziare",100,200);
</script>
</body>
</html>
