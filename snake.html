<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Snake</title>
<style>
body { font-family: Arial; text-align:center; background:#222; color:white; }
canvas { display:block; margin:20px auto; background:#333; border-radius:10px; }
button { margin:5px; padding:10px 15px; border:none; border-radius:5px; background:#4CAF50; color:white; cursor:pointer; }
button:hover { background:#45a049; }
.touch-controls { display:flex; justify-content:center; margin-top:10px; }
.touch-controls button { width:50px; height:50px; margin:5px; font-size:20px; }
</style>
</head>
<body>
<h1>Snake</h1>
<canvas id="game" width="400" height="400"></canvas><br>
<button id="playBtn">Play</button>
<button id="pauseBtn">Pausa</button>
<button id="replayBtn">Replay</button>

<div class="touch-controls">
  <button id="up">⬆️</button>
  <button id="down">⬇️</button>
  <button id="left">⬅️</button>
  <button id="right">➡️</button>
</div>

<script>
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");

let snake=[{x:10,y:10}], dx=20, dy=0, food={x:0,y:0}, interval=null, running=false;
let move={up:false,down:false,left:false,right:false};

function placeFood(){
  food.x=Math.floor(Math.random()*20)*20;
  food.y=Math.floor(Math.random()*20)*20;
}

function draw(){
  ctx.fillStyle="#333"; ctx.fillRect(0,0,canvas.width,canvas.height);
  ctx.fillStyle="lime"; snake.forEach(s=>ctx.fillRect(s.x,s.y,20,20));
  ctx.fillStyle="red"; ctx.fillRect(food.x,food.y,20,20);
}

function update(){
  let head={x:snake[0].x+dx, y:snake[0].y+dy};
  if(head.x<0||head.x>=canvas.width||head.y<0||head.y>=canvas.height || snake.some(s=>s.x===head.x && s.y===head.y)){
    pauseGame(); alert("Game Over!"); return;
  }
  snake.unshift(head);
  if(head.x===food.x && head.y===food.y) placeFood();
  else snake.pop();
  draw();
}

function startGame(){ if(!interval){ interval=setInterval(update,150); running=true; } }
function pauseGame(){ clearInterval(interval); interval=null; running=false; }
function replayGame(){ pauseGame(); snake=[{x:10,y:10}]; dx=20; dy=0; placeFood(); startGame(); }

document.getElementById("playBtn").onclick=startGame;
document.getElementById("pauseBtn").onclick=pauseGame;
document.getElementById("replayBtn").onclick=replayGame;

// tasti PC
document.addEventListener("keydown",e=>{
  if(["ArrowUp","KeyW"].includes(e.code)&&dy===0){dx=0;dy=-20;}
  if(["ArrowDown","KeyS"].includes(e.code)&&dy===0){dx=0;dy=20;}
  if(["ArrowLeft","KeyA"].includes(e.code)&&dx===0){dx=-20;dy=0;}
  if(["ArrowRight","KeyD"].includes(e.code)&&dx===0){dx=20;dy=0;}
});

// touch
document.getElementById("up").onclick=()=>{ if(dy===0){dx=0;dy=-20;} }
document.getElementById("down").onclick=()=>{ if(dy===0){dx=0;dy=20;} }
document.getElementById("left").onclick=()=>{ if(dx===0){dx=-20;dy=0;} }
document.getElementById("right").onclick=()=>{ if(dx===0){dx=20;dy=0;} }

placeFood();
draw();
</script>
</body>
</html>
