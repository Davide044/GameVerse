<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Snake</title>
<style>
body {
  font-family: Arial, sans-serif;
  text-align: center;
  background: linear-gradient(135deg,#74ebd5,#ACB6E5);
  color: #fff;
}
canvas {
  display: block;
  margin: 20px auto;
  background: #222;
  border-radius: 10px;
}
button {
  margin: 5px;
  padding: 10px 15px;
  border: none;
  border-radius: 5px;
  background: #4CAF50;
  color: white;
  cursor: pointer;
}
button:hover { background: #45a049; }
.touch-controls {
  display: flex;
  justify-content: center;
  margin-top: 10px;
}
.touch-controls button {
  width: 50px;
  height: 50px;
  margin: 5px;
  font-size: 20px;
}
</style>
</head>
<body>
<h1>Snake</h1>
<canvas id="game" width="400" height="400"></canvas><br>
<button id="playBtn">Play</button>
<button id="pauseBtn">Pausa</button>
<button id="replayBtn">Replay</button>

<div class="touch-controls">
  <button id="up">⬆️</button>
  <button id="left">⬅️</button>
  <button id="down">⬇️</button>
  <button id="right">➡️</button>
</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

const grid = 20;
let snake = [{x: 200, y: 200}];
let dx = grid, dy = 0;
let food = {x: 0, y: 0};
let interval = null;

function placeFood() {
  food.x = Math.floor(Math.random() * (canvas.width / grid)) * grid;
  food.y = Math.floor(Math.random() * (canvas.height / grid)) * grid;
}
placeFood();

function draw() {
  ctx.fillStyle = "#222";
  ctx.fillRect(0, 0, canvas.width, canvas.height);

  // Serpente
  ctx.fillStyle = "lime";
  snake.forEach((s, i) => {
    ctx.fillRect(s.x, s.y, grid, grid);
    // bordo serpente più scuro
    ctx.strokeStyle = "darkgreen";
    ctx.strokeRect(s.x, s.y, grid, grid);
  });

  // Mela
  ctx.fillStyle = "red";
  ctx.beginPath();
  ctx.arc(food.x + grid/2, food.y + grid/2, grid/2, 0, Math.PI*2);
  ctx.fill();
}

function update() {
  let head = {x: snake[0].x + dx, y: snake[0].y + dy};

  // Collisione muri
  if(head.x < 0 || head.x >= canvas.width || head.y < 0 || head.y >= canvas.height) {
    pauseGame();
    alert("Game Over!");
    return;
  }

  // Collisione serpente
  if(snake.some(s => s.x === head.x && s.y === head.y)) {
    pauseGame();
    alert("Game Over!");
    return;
  }

  snake.unshift(head);

  // Mangia mela
  if(head.x === food.x && head.y === food.y) {
    placeFood();
  } else {
    snake.pop();
  }

  draw();
}

function startGame() { if(!interval) interval = setInterval(update, 150); }
function pauseGame() { clearInterval(interval); interval = null; }
function replayGame() { 
  pauseGame();
  snake = [{x: 200, y: 200}];
  dx = grid; dy = 0;
  placeFood();
  draw();
}

document.getElementById("playBtn").onclick = startGame;
document.getElementById("pauseBtn").onclick = pauseGame;
document.getElementById("replayBtn").onclick = replayGame;

// Controlli PC
document.addEventListener("keydown", e => {
  if(e.code === "ArrowUp" && dy === 0){ dx = 0; dy = -grid; }
  if(e.code === "ArrowDown" && dy === 0){ dx = 0; dy = grid; }
  if(e.code === "ArrowLeft" && dx === 0){ dx = -grid; dy = 0; }
  if(e.code === "ArrowRight" && dx === 0){ dx = grid; dy = 0; }
});

// Touch mobile
document.getElementById("up").onclick = () => { if(dy === 0){ dx = 0; dy = -grid; } }
document.getElementById("down").onclick = () => { if(dy === 0){ dx = 0; dy = grid; } }
document.getElementById("left").onclick = () => { if(dx === 0){ dx = -grid; dy = 0; } }
document.getElementById("right").onclick = () => { if(dx === 0){ dx = grid; dy = 0; } }

draw();
</script>
</body>
</html>
